@startuml phase1-architecture
skinparam backgroundColor #FFFFFF
skinparam componentStyle rectangle

title Phase 1 アーキテクチャ

actor "ユーザー" as User

rectangle "Vercel" #E5F5FF {
  component "Next.js\nApp" as NextJS
}

database "Supabase\nPostgreSQL" as DB #E5FFE5

cloud "OpenAI" #FFF5E5 {
  component "Deep Research API" as DeepResearch
}

rectangle "GitHub Actions" #FFE5E5 {
  component "Cron\n(15分ごと)" as Cron
}

User -down-> NextJS : 1. 分析リクエスト
NextJS -down-> DB : 2. ジョブ作成・更新
NextJS -right-> DeepResearch : 3. Deep Research\n(background: true)
DeepResearch -left-> NextJS : 4. Webhook\n(response.completed)
Cron -down-> NextJS : 5. 定期ステータス確認\n新規ジョブ開始

note right of DeepResearch
  非同期処理
  Webhookで完了通知
end note

note bottom of Cron
  15分ごとに実行
  バッチ処理制御
end note

@enduml
